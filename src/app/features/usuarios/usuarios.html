<div class="usuarios-container">
  <div class="table-header">
    <h2>{{ mostrarFormulario ? 'Registrar Nuevo Usuario' : 'Gesti√≥n de Usuarios' }}</h2>
    <button [class]="mostrarFormulario ? 'btn-cancel' : 'btn-new'" (click)="toggleFormulario()">
      <span class="icon">{{ mostrarFormulario ? '‚úï' : '+' }}</span>
      {{ mostrarFormulario ? 'Cancelar' : 'Nuevo Usuario' }}
    </button>
  </div>

  @if (mostrarFormulario) {
  <div class="form-card animate-in">
    <div class="form-content">
      <div class="input-field">
        <label>Nombre Completo</label>
        <input type="text" [(ngModel)]="nuevoUsuario.nombre" placeholder="Ej: Hawell Snayder">
      </div>

      <div class="input-field">
        <label>Usuario (Username)</label>
        <input type="text" [(ngModel)]="nuevoUsuario.username" placeholder="ej: hawell123">
      </div>

      <div class="input-field">
        <label>Contrase√±a</label>
        <input type="password" [(ngModel)]="nuevoUsuario.password" placeholder="********">
      </div>

      <div class="input-field">
        <label>Rol del Sistema</label>
        <select [(ngModel)]="nuevoUsuario.rolId">
          <option [value]="1">Administrador</option>
          <option [value]="2">Cajero</option>
          <option [value]="3">Cocina</option>
          <option [value]="4">Mesero</option>
        </select>
      </div>

      <div class="form-actions">
        <button class="btn-save" (click)="registrarUsuario()">
          üíæ Guardar Usuario
        </button>
      </div>
    </div>
  </div>
  }

  <div class="table-card">
    <table class="styled-table">
      <thead>
      <tr>
        <th class="id-column">ID</th>
        <th>USUARIO</th>
        <th>ROL</th>
        <th class="text-center">ESTADO</th>
        <th class="text-center">ACCIONES</th>
      </tr>
      </thead>
      <tbody>
      @for (u of usuarios; track u.id) {
      <tr [class.user-inactive]="!u.activo">
        <td class="id-column">{{ u.id }}</td>
        <td>
          <div class="user-info">
            <div class="avatar" [class.avatar-off]="!u.activo">
              {{ (u.nombre || u.username).charAt(0).toUpperCase() }}
            </div>
            <div class="user-text">
              <span class="full-name">{{ u.nombre }}</span>
              <small class="user-tag">@{{ u.username }}</small>
            </div>
          </div>
        </td>
        <td><span class="badge" [ngClass]="u.rol">{{ u.rol }}</span></td>

        <td class="text-center">
            <span class="status-indicator" [class.active]="u.activo">
              {{ u.activo ? 'Activo' : 'Inactivo' }}
            </span>
        </td>

        <td class="text-center">
          <div class="action-buttons">
            <button
              class="btn-action"
              [class.btn-deactivate]="u.activo"
              [class.btn-activate]="!u.activo"
              (click)="toggleEstado(u)"
              [title]="u.activo ? 'Desactivar Usuario' : 'Activar Usuario'">

              <span class="icon">{{ u.activo ? 'üö´' : '‚úÖ' }}</span>

            </button>

            <button
              class="btn-action btn-delete"
              (click)="eliminarUsuario(u.id, u.username)"
              title="Eliminar permanentemente">
              üóëÔ∏è
            </button>
          </div>
        </td>
      </tr>
      }
      </tbody>
    </table>
  </div>
</div>
