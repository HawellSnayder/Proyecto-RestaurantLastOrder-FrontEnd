<div class="mesas-page-wrapper">
  <div class="mesas-header">
    <div class="header-info">
      <h1>Panel de Mesas</h1>
      <p>GestiÃ³n de disponibilidad y atenciÃ³n al cliente</p>
    </div>
    <button class="btn-add-mesa" (click)="mostrarFormulario = !mostrarFormulario">
      {{ mostrarFormulario ? 'âœ• Cancelar' : 'ï¼‹ Nueva Mesa' }}
    </button>
  </div>

  <div *ngIf="mostrarFormulario" class="card-formulario fade-in">
    <h3>Registrar Nueva Mesa</h3>
    <div class="form-row">
      <div class="input-group">
        <label>NÃºmero de Mesa</label>
        <input type="number" class="custom-input" [(ngModel)]="nuevaMesa.numero" placeholder="Ej: 05">
      </div>
      <div class="input-group">
        <label>Capacidad</label>
        <input type="number" class="custom-input" [(ngModel)]="nuevaMesa.capacidad" placeholder="Ej: 4">
      </div>
      <button class="btn-confirm-add" (click)="guardarMesa()">Confirmar Registro</button>
    </div>
  </div>

  <div class="mesas-stats">
    <div class="stat-item"><span class="dot libre"></span> Libres</div>
    <div class="stat-item"><span class="dot ocupada"></span> Ocupadas</div>
    <div class="stat-item"><span class="dot reservada"></span> Reservadas</div>
  </div>

  <div class="mesas-grid">
    <div *ngFor="let mesa of mesas"
         class="mesa-card"
         [ngClass]="mesa.estado.toLowerCase()"
         (click)="seleccionarMesa(mesa.id)">

      <div class="mesa-actions-overlay" *ngIf="mesaActivaId === mesa.id">
        <div class="overlay-content">
          <button *ngIf="mesa.estado === 'LIBRE'" class="btn-action" (click)="ejecutarAccion(mesa.id, 'ocupar'); $event.stopPropagation()">
            ğŸ“Œ Ocupar Mesa
          </button>
          <button *ngIf="mesa.estado === 'LIBRE'" class="btn-action" (click)="ejecutarAccion(mesa.id, 'reservar'); $event.stopPropagation()">
            ğŸ“… Reservar
          </button>
          <button *ngIf="mesa.estado === 'RESERVADA'" class="btn-action" (click)="ejecutarAccion(mesa.id, 'ocupar'); $event.stopPropagation()">
            ğŸ™‹â€â™‚ï¸ LlegÃ³ Cliente
          </button>

          <button *ngIf="mesa.estado === 'OCUPADA'"
                  class="btn-action"
                  [class.disabled-action]="mesa.tienePedidoActivo"
                  (click)="ejecutarAccion(mesa.id, 'liberar'); $event.stopPropagation()">
            {{ mesa.tienePedidoActivo ? 'âš ï¸ Cuenta Pendiente' : 'ğŸ”“ Liberar Mesa' }}
          </button>

          <button class="btn-close-overlay" (click)="mesaActivaId = null; $event.stopPropagation()">
            Volver
          </button>
        </div>
      </div>

      <div class="alert-icon" *ngIf="mesa.tienePedidoActivo">ğŸ””</div>

      <div class="mesa-info">
        <span class="mesa-label">MESA</span>
        <div class="mesa-numero">{{ mesa.numero }}</div>
        <div class="mesa-capacidad">Capacidad: {{ mesa.capacidad }} pers.</div>
      </div>

      <div class="mesa-badge-container">
        <span class="mesa-badge">{{ mesa.estado }}</span>
      </div>

      <button class="btn-del" (click)="eliminarMesa(mesa.id, $event)">âœ•</button>
    </div>
  </div>
</div>
